# 퀴즈 수정 기능 가이드

**추가 날짜**: 2025-11-26  
**버전**: v2.10.1 (예정)

---

## ✨ 새로운 기능

### 퀴즈 수정 기능
관리자 페이지에서 기존에 저장된 퀴즈를 불러와 수정할 수 있습니다.

---

## 🎯 사용 방법

### 1. 퀴즈 관리 탭 접속
```
1. https://g2.sedaily.ai/admin/quiz 접속
2. "퀴즈 관리" 탭 클릭 (기존 "퀴즈 삭제" 탭이 변경됨)
```

### 2. 수정할 퀴즈 선택
```
1. 게임 타입 선택 (블랙스완, 죄수의 딜레마, 시그널 디코딩)
2. 날짜 선택 (드롭다운에서 선택)
3. 문제 목록 확인
4. "수정" 버튼 클릭
```

### 3. 퀴즈 수정
```
1. "퀴즈 관리" 탭으로 자동 이동
2. "수정 모드" 배지 표시됨
3. 불러온 문제들을 수정
   - 이전/다음 버튼으로 문제 간 이동
   - 문제 내용, 선택지, 정답, 해설 등 수정
   - 문제 추가/삭제 가능
4. "저장" 버튼 클릭
```

### 4. 저장 완료
```
1. 기존 퀴즈가 수정된 내용으로 덮어쓰기됨
2. 캐시 자동 초기화
3. 수정 모드 자동 해제
4. 새 문제 작성 모드로 전환
```

---

## 🔧 기술 구조

### 데이터 변환 흐름
```typescript
// 1. Lambda Question (DynamoDB) → QuizQuestion (Frontend)
Lambda Question {
  questionType: "객관식",
  question: "문제 내용",
  options: ["A", "B", "C", "D"],
  answer: "2",  // 1-based index
  explanation: "해설"
}
  ↓ 변환
QuizQuestion {
  questionType: "객관식",
  question_text: "문제 내용",
  choices: ["A", "B", "C", "D"],
  correct_index: 1,  // 0-based index
  explanation: "해설"
}

// 2. 수정 후 저장 시 다시 Lambda 형식으로 변환
QuizQuestion → Lambda Question → DynamoDB 저장
```

### 주요 변경 파일
```
app/admin/quiz/page.tsx
  - isEditMode 상태 추가
  - "수정 모드" 배지 표시
  - "새 문제 작성" 버튼 추가

components/admin/QuizList.tsx
  - onEdit prop 추가
  - "수정" 버튼 추가
  - handleEdit() 함수: Lambda → QuizQuestion 변환
  - 제목 변경: "퀴즈 삭제" → "퀴즈 관리"
```

---

## 📊 UI 변경사항

### Before (v2.10.0)
```
탭: [퀴즈 관리] [Quizlet 관리] [퀴즈 삭제] [캐시 관리]

퀴즈 삭제 탭:
- 게임 타입 선택
- 날짜 선택
- [삭제] 버튼만 존재
```

### After (v2.10.1)
```
탭: [퀴즈 관리] [Quizlet 관리] [퀴즈 관리] [캐시 관리]

퀴즈 관리 탭:
- 게임 타입 선택
- 날짜 선택
- [수정] [삭제] 버튼 존재

퀴즈 관리 탭 (수정 모드):
- "수정 모드" 배지 표시
- 불러온 문제들 표시
- [새 문제 작성] 버튼으로 수정 모드 해제
```

---

## ⚠️ 주의사항

### 1. 덮어쓰기 방식
- 수정 후 저장하면 **기존 퀴즈가 완전히 덮어쓰기**됩니다
- 삭제한 문제는 복구할 수 없습니다
- 저장 전에 반드시 확인하세요

### 2. 날짜 변경 불가
- 수정 모드에서는 날짜를 변경할 수 없습니다
- 날짜를 변경하려면:
  1. 기존 퀴즈 삭제
  2. 새 날짜로 다시 생성

### 3. 게임 타입 유지
- 불러온 퀴즈의 게임 타입은 자동으로 유지됩니다
- 첫 번째 문제의 theme이 전체 세트의 theme이 됩니다

### 4. 캐시 자동 초기화
- 수정 후 저장하면 캐시가 자동으로 초기화됩니다
- 사용자는 브라우저 새로고침만 하면 수정된 내용을 볼 수 있습니다

---

## 🔄 워크플로우 예시

### 시나리오: 2025-11-26 죄수의 딜레마 퀴즈 수정

```
1. 관리자 페이지 접속
   ↓
2. "퀴즈 관리" 탭 클릭
   ↓
3. "죄수의 딜레마" 선택
   ↓
4. "2025-11-26" 선택
   ↓
5. 3개 문제 확인
   ↓
6. "수정" 버튼 클릭
   ↓
7. "퀴즈 관리" 탭으로 자동 이동
   ↓
8. "수정 모드" 배지 확인
   ↓
9. 첫 번째 문제 수정
   - 문제 내용 수정
   - 선택지 수정
   - 해설 추가
   ↓
10. "다음" 버튼으로 두 번째 문제 이동
   ↓
11. 두 번째 문제 수정
   ↓
12. "문제 추가" 버튼으로 네 번째 문제 추가
   ↓
13. "저장" 버튼 클릭
   ↓
14. "4개 문제가 성공적으로 저장되었습니다!" 메시지
   ↓
15. 수정 모드 자동 해제
   ↓
16. 완료!
```

---

## 🐛 트러블슈팅

### 문제: 수정 버튼을 눌렀는데 빈 문제가 표시됨
**원인**: 데이터 변환 오류  
**해결**: 
1. 브라우저 콘솔 확인
2. 날짜 형식 확인 (YYYY-MM-DD)
3. 페이지 새로고침 후 재시도

### 문제: 저장 후에도 이전 내용이 표시됨
**원인**: 캐시 문제  
**해결**:
1. "캐시 관리" 탭에서 수동 캐시 초기화
2. 브라우저 강력 새로고침 (Cmd+Shift+R)

### 문제: 주관식 문제의 답이 사라짐
**원인**: 주관식은 choices[0]에 답이 저장됨  
**해결**: 
- 코드에서 자동 처리되므로 정상 동작
- 답이 비어있다면 원본 데이터 확인 필요

---

## 📈 향후 개선 방향

### 단기
- [ ] 수정 전 미리보기 기능
- [ ] 변경사항 하이라이트
- [ ] 수정 이력 저장

### 중기
- [ ] 일괄 수정 기능 (여러 날짜 동시 수정)
- [ ] 문제 복사/붙여넣기
- [ ] 드래그 앤 드롭으로 문제 순서 변경

### 장기
- [ ] 버전 관리 시스템
- [ ] 수정 권한 관리
- [ ] 수정 로그 및 감사 추적

---

**작성일**: 2025-11-26  
**작성자**: Amazon Q  
**상태**: ✅ 구현 완료
